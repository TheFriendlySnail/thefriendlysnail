<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weighted Skewer - The Friendly Snail</title>
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="icon" href="/favicon.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar">
  <div class="nav-container">
    <a href="/" class="logo-link">
      <img src="../../assets/logo.png" alt="The Friendly Snail Logo" class="logo">
    </a>
    <ul class="nav-links">
      <li><a href="/about/">About</a></li>
      <li><a href="/contact/">Contact</a></li>
      <li><a href="/shop/">Shop</a></li>
      <li><a href="/checkout/"><i class="fas fa-shopping-cart"></i></a></li>
    </ul>
  </div>
</nav>

<div class="container">
  <!-- Product Gallery -->
  <div class="product-images">
    <img id="mainImage" src="" alt="Main Product Image" class="main-image">
    <div class="thumbnail-images">
      <img src="/assets/weightedskewer1.jpg" alt="Thumbnail 1" class="thumbnail" onclick="changeImage(this)">
      <img src="/assets/weightedskewer2.jpg" alt="Thumbnail 2" class="thumbnail" onclick="changeImage(this)">
      <img src="/assets/weightedskewer3.jpg" alt="Thumbnail 3" class="thumbnail" onclick="changeImage(this)">
    </div>
  </div>
  

  <!-- Product Details -->
  <div class="details">
    <h1>Weighted Skewer</h1>
    <p class="price" id="price">$0.99</p>

    <label for="quantity">Quantity</label>
    <input type="number" id="quantity" value="1" min="1">

    <button class="add-to-cart" onclick="addToCart()">Add to Cart</button>
  </div>
</div>

<!-- Accordion Sections -->
<div class="accordion">
  <div class="accordion-section">
    <div class="accordion-header" onclick="toggleAccordion(this)">Description</div>
    <div class="accordion-content">A nice metal skewer that will make your snail burgers float the bottom of the tank, allowing you snails to eat peacefully</div>
  </div>

  <div class="accordion-section">
    <div class="accordion-header" onclick="toggleAccordion(this)">Directions for Use</div>
    <div class="accordion-content">Stab one of the pointy ends into your item of foor and stick it in the tank
    </div>
  </div>

  <!-- Reviews -->
  <div class="accordion-section">
    <div class="accordion-header" onclick="toggleAccordion(this)">Reviews</div>
    <div class="accordion-content">
      <div class="review-form">
        <label>Rating:</label>
        <div class="stars" id="starRating">
          <span data-value="1">&#9733;</span>
          <span data-value="2">&#9733;</span>
          <span data-value="3">&#9733;</span>
          <span data-value="4">&#9733;</span>
          <span data-value="5">&#9733;</span>
        </div>

  <textarea id="reviewText" placeholder="Write your review..."></textarea>
  <button class="add-to-cart" onclick="submitReview()">Submit Review</button>
</div>


      <div class="sort-reviews">
        Sort by:
        <select onchange="sortReviews(this.value)">
          <option value="latest">Latest</option>
          <option value="high">Highest Rating</option>
          <option value="low">Lowest Rating</option>
        </select>
      </div>

      <div id="reviews" class="reviews"></div>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="site-footer">
  <div class="footer-left">
    <p>The Friendly Snail</p>
   </div>
  <div class="footer-right">
    <p>Email: <a href="mailto:business.gabelawrence@gmail.com">business.gabelawrence@gmail.com</a></p>
    <p>Phone: <a href="tel:+61493474198">0493 474 198</a></p>
  </div>
</footer>

<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<script>
  let currentPrice = 4.99;
  let reviews = JSON.parse(localStorage.getItem('reviews')) || [];

  // On page load, display stored reviews
  window.onload = function() {
    displayReviews();
  };

  function changeImage(img) {
    document.getElementById('mainImage').src = img.src;
  }

  window.addEventListener('DOMContentLoaded', () => {
    const firstThumbnail = document.querySelector('.thumbnail');
    if (firstThumbnail) {
      document.getElementById('mainImage').src = firstThumbnail.src;
    }
  });


  function updatePrice() {
    const selected = document.getElementById('size').value;
    currentPrice = parseFloat(selected);
    document.getElementById('price').textContent = `$${currentPrice.toFixed(2)}`;
  }

  function addToCart() {
    const qty = parseInt(document.getElementById('quantity').value, 10);
    const size = document.getElementById('size').options[document.getElementById('size').selectedIndex].text;
    alert(`Added ${qty} x ${size} Snail Burger(s) to cart for $${(qty * currentPrice).toFixed(2)}.`);
    // Replace this with Stripe/cart integration as needed
  }

  function toggleAccordion(header) {
    const content = header.nextElementSibling;
    content.style.display = content.style.display === 'block' ? 'none' : 'block';
  }

  let selectedRating = 0;

  document.querySelectorAll('#starRating span').forEach(star => {
    star.addEventListener('click', function () {
      selectedRating = parseInt(this.getAttribute('data-value'));
      updateStars(selectedRating);
    });
  
    star.addEventListener('mouseover', function () {
      updateStars(parseInt(this.getAttribute('data-value')), true);
    });

    star.addEventListener('mouseout', function () {
      updateStars(selectedRating);
    });
  });

  function updateStars(rating, hover = false) {
    document.querySelectorAll('#starRating span').forEach(star => {
      const value = parseInt(star.getAttribute('data-value'));
      star.classList.remove('selected', 'hover');
      if (hover) {
        if (value <= rating) star.classList.add('hover');
      } else {
        if (value <= rating) star.classList.add('selected');
      }
    });
  }


  function submitReview() {
    const text = document.getElementById('reviewText').value.trim();
    if (!text || selectedRating === 0) return;
  
    const review = {
      text: text,
      rating: selectedRating,
      date: new Date()
    };

    reviews.push(review);
    localStorage.setItem('reviews', JSON.stringify(reviews));
    document.getElementById('reviewText').value = '';
    selectedRating = 0;
    updateStars(0);
    displayReviews();
  }


  function sortReviews(type) {
    if (type === 'high') {
      reviews.sort((a, b) => b.rating - a.rating);
    } else if (type === 'low') {
      reviews.sort((a, b) => a.rating - b.rating);
    } else {
      reviews.sort((a, b) => b.date - a.date);
    }
    displayReviews();
  }

function displayReviews() {
  const container = document.getElementById('reviews');
  container.innerHTML = '';
  reviews.forEach(review => {
    const div = document.createElement('div');
    div.className = 'review';

    const stars = '★'.repeat(review.rating) + '☆'.repeat(5 - review.rating);

    div.innerHTML = `
      <div><strong>Rating:</strong> <span style="color: gold;">${stars}</span></div>
      <div>${review.text}</div>
    `;
    container.appendChild(div);
  });
}
</script>

<script>
  function changeImage(img) {
    const mainImage = document.getElementById('mainImage');
    if (mainImage && img) {
      mainImage.src = img.src;
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    const firstThumbnail = document.querySelector('.thumbnail');
    if (firstThumbnail) {
      changeImage(firstThumbnail);
    }
  });
</script>

</body>
</html>
